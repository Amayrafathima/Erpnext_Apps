var m=(e,s,t)=>new Promise((o,r)=>{var n=d=>{try{a(t.next(d))}catch(c){r(c)}},u=d=>{try{a(t.throw(d))}catch(c){r(c)}},a=d=>d.done?o(d.value):Promise.resolve(d.value).then(n,u);a((t=t.apply(e,s)).next())});import{aq as p,ar as B,as as M,an as F,am as H,at as q,au as y,av as U,aw as Y,ax as $}from"./index-a4ebe9d4.js";/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const D=new WeakMap,T=(e,s,t,o=0,r=!1)=>{D.has(e)!==t&&(t?W(e,s,o,r):z(e,s))},G=e=>e===e.getRootNode().activeElement,W=(e,s,t,o=!1)=>{const r=s.parentNode,n=s.cloneNode(!1);n.classList.add("cloned-input"),n.tabIndex=-1,o&&(n.disabled=!0),r.appendChild(n),D.set(e,n);const a=e.ownerDocument.dir==="rtl"?9999:-9999;e.style.pointerEvents="none",s.style.transform=`translate3d(${a}px,${t}px,0) scale(0)`},z=(e,s)=>{const t=D.get(e);t&&(D.delete(e),t.remove()),e.style.pointerEvents="",s.style.transform=""},k=50,j=(e,s,t)=>{if(!t||!s)return()=>{};const o=a=>{G(s)&&T(e,s,a)},r=()=>T(e,s,!1),n=()=>o(!0),u=()=>o(!1);return B(t,"ionScrollStart",n),B(t,"ionScrollEnd",u),s.addEventListener("blur",r),()=>{M(t,"ionScrollStart",n),M(t,"ionScrollEnd",u),s.removeEventListener("blur",r)}},C="input, textarea, [no-blur], [contenteditable]",J=()=>{let e=!0,s=!1;const t=document,o=()=>{s=!0},r=()=>{e=!0},n=u=>{if(s){s=!1;return}const a=t.activeElement;if(!a||a.matches(C))return;const d=u.target;d!==a&&(d.matches(C)||d.closest(C)||(e=!1,setTimeout(()=>{e||a.blur()},50)))};return B(t,"ionScrollStart",o),t.addEventListener("focusin",r,!0),t.addEventListener("touchend",n,!1),()=>{M(t,"ionScrollStart",o,!0),t.removeEventListener("focusin",r,!0),t.removeEventListener("touchend",n,!1)}},Q=.3,V=(e,s,t,o)=>{var r;const n=(r=e.closest("ion-item,[ion-item]"))!==null&&r!==void 0?r:e;return X(n.getBoundingClientRect(),s.getBoundingClientRect(),t,o)},X=(e,s,t,o)=>{const r=e.top,n=e.bottom,u=s.top,a=Math.min(s.bottom,o-t),d=u+15,v=a-k-n,l=d-r,f=Math.round(v<0?-v:l>0?-l:0),S=Math.min(f,r-u),I=Math.abs(S)/Q,i=Math.min(400,Math.max(150,I));return{scrollAmount:S,scrollDuration:i,scrollPadding:t,inputSafeY:-(r-d)+4}},_="$ionPaddingTimer",K=(e,s,t)=>{const o=e[_];o&&clearTimeout(o),s>0?e.style.setProperty("--keyboard-offset",`${s}px`):e[_]=setTimeout(()=>{e.style.setProperty("--keyboard-offset","0px"),t&&t()},120)},N=(e,s,t)=>{const o=()=>{s&&K(s,0,t)};e.addEventListener("focusout",o,{once:!0})};let A=0;const x="data-ionic-skip-scroll-assist",Z=(e,s,t,o,r,n,u,a=!1)=>{const d=n&&(u===void 0||u.mode===q.None);let c=!1;const v=y!==void 0?y.innerHeight:0,l=w=>{if(c===!1){c=!0;return}O(e,s,t,o,w.detail.keyboardHeight,d,a,v,!1)},f=()=>{c=!1,y===null||y===void 0||y.removeEventListener("ionKeyboardDidShow",l),e.removeEventListener("focusout",f,!0)},S=()=>m(void 0,null,function*(){if(s.hasAttribute(x)){s.removeAttribute(x);return}O(e,s,t,o,r,d,a,v),y===null||y===void 0||y.addEventListener("ionKeyboardDidShow",l),e.addEventListener("focusout",f,!0)});return e.addEventListener("focusin",S,!0),()=>{e.removeEventListener("focusin",S,!0),y===null||y===void 0||y.removeEventListener("ionKeyboardDidShow",l),e.removeEventListener("focusout",f,!0)}},P=e=>{document.activeElement!==e&&(e.setAttribute(x,"true"),e.focus())},O=(e,s,t,o,r,n,u=!1,a=0,d=!0)=>m(void 0,null,function*(){if(!t&&!o)return;const c=V(e,t||o,r,a);if(t&&Math.abs(c.scrollAmount)<4){P(s),n&&t!==null&&(K(t,A),N(s,t,()=>A=0));return}if(T(e,s,!0,c.inputSafeY,u),P(s),U(()=>e.click()),n&&t&&(A=c.scrollPadding,K(t,A)),typeof window!="undefined"){let v;const l=()=>m(void 0,null,function*(){v!==void 0&&clearTimeout(v),window.removeEventListener("ionKeyboardDidShow",f),window.removeEventListener("ionKeyboardDidShow",l),t&&(yield $(t,0,c.scrollAmount,c.scrollDuration)),T(e,s,!1,c.inputSafeY),P(s),n&&N(s,t,()=>A=0)}),f=()=>{window.removeEventListener("ionKeyboardDidShow",f),window.addEventListener("ionKeyboardDidShow",l)};if(t){const S=yield Y(t),w=S.scrollHeight-S.clientHeight;if(d&&c.scrollAmount>w-S.scrollTop){s.type==="password"?(c.scrollAmount+=k,window.addEventListener("ionKeyboardDidShow",f)):window.addEventListener("ionKeyboardDidShow",l),v=setTimeout(l,1e3);return}}l()}}),E=!0,oe=(e,s)=>m(void 0,null,function*(){const t=document,o=s==="ios",r=s==="android",n=e.getNumber("keyboardHeight",290),u=e.getBoolean("scrollAssist",!0),a=e.getBoolean("hideCaretOnScroll",o),d=e.getBoolean("inputBlurring",o),c=e.getBoolean("scrollPadding",!0),v=Array.from(t.querySelectorAll("ion-input, ion-textarea")),l=new WeakMap,f=new WeakMap,S=yield p.getResizeMode(),w=i=>m(void 0,null,function*(){yield new Promise(g=>F(i,g));const h=i.shadowRoot||i,L=h.querySelector("input")||h.querySelector("textarea"),b=H(i),R=b?null:i.closest("ion-footer");if(!L)return;if(b&&a&&!l.has(i)){const g=j(i,L,b);l.set(i,g)}if(!(L.type==="date"||L.type==="datetime-local")&&(b||R)&&u&&!f.has(i)){const g=Z(i,L,b,R,n,c,S,r);f.set(i,g)}}),I=i=>{if(a){const h=l.get(i);h&&h(),l.delete(i)}if(u){const h=f.get(i);h&&h(),f.delete(i)}};d&&E&&J();for(const i of v)w(i);t.addEventListener("ionInputDidLoad",i=>{w(i.detail)}),t.addEventListener("ionInputDidUnload",i=>{I(i.detail)})});export{oe as startInputShims};
