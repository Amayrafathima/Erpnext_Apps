var p=(h,c,d)=>new Promise((m,n)=>{var k=o=>{try{i(d.next(o))}catch(f){n(f)}},C=o=>{try{i(d.throw(o))}catch(f){n(f)}},i=o=>o.done?m(o.value):Promise.resolve(o.value).then(k,C);i((d=d.apply(h,c)).next())});import{X as L,G as x,g as T,h as M,i as q,e as A,l as K,K as S,r as z,c as G,w as u,u as e,o as _,b as r,a,p as v,n as y,t as w,x as N,q as Q,F as U,d as X,I as Y,Q as H,R as J}from"./index-a4ebe9d4.js";import{f as W}from"./formatters-c8b2d612.js";import Z from"./ProfileInfoModal-ed6010b1.js";import"./FormattedField-7a8ff0b9.js";import"./Badge.vue_vue_type_script_setup_true_lang-c7a62ffe.js";import"./EmployeeAvatar-7cb223ed.js";import"./Avatar.vue_vue_type_script_setup_true_lang-bcd6ccc1.js";const ee=h=>p(void 0,null,function*(){yield(yield L.create({header:"Error",message:h,buttons:["OK"]})).present()}),te={class:"flex flex-col h-screen w-screen"},oe={class:"w-full sm:w-96"},se={class:"flex flex-row bg-white shadow-sm py-4 px-3 items-center justify-between border-b sticky top-0 z-10"},ae={class:"flex flex-row items-center"},ne=a("h2",{class:"text-xl font-semibold text-gray-900"},"Profile",-1),le={class:"flex flex-col items-center mt-5 p-4"},re=["src","alt"],ce={key:1,class:"flex items-center justify-center bg-gray-200 uppercase text-gray-600 h-24 w-24 rounded-full object-cover"},ie={class:"flex flex-col gap-1.5 items-center mt-2 mb-5"},de={key:0,class:"text-lg font-bold text-gray-900"},me={key:1,class:"font-normal text-sm text-gray-500"},ue={class:"flex flex-col gap-5 my-4 w-full"},_e={class:"flex flex-col bg-white rounded"},fe=["onClick"],pe={class:"flex flex-row items-center gap-3 grow"},ye={class:"text-base font-normal text-gray-800"},g="Employee",Ie={__name:"Profile",setup(h){const c=x("$socket"),d=x("$session"),m=x("$user"),n=x("$employee"),k=T(),C=[{icon:"user",title:"Employee Details",fields:["employee_name","employee_number","gender","date_of_birth","date_of_joining","blood_group"]},{icon:"file",title:"Company Information",fields:["company","department","designation","branch","grade","reports_to","employment_type"]},{icon:"book",title:"Contact Information",fields:["cell_number","personal_email","company_email","preferred_email"]},{icon:"dollar-sign",title:"Salary Information",fields:["ctc","payroll_cost_center","pan_number","provident_fund_account","salary_mode","bank_name","bank_ac_no","ifsc_code","micr_code","iban"]}],i=M(!1),o=M(null),f=t=>p(this,null,function*(){o.value=t,i.value=!0}),O=t=>p(this,null,function*(){i.value=!1,o.value=null}),I=q({doctype:g,name:n.data.name,fields:"*",auto:!0,transform:t=>(t.ctc=W(t.ctc,t.salary_currency),t)}),P=A({url:"hrms.api.get_doctype_fields",params:{doctype:g},auto:!0}),R=t=>{const s=P.data.find(b=>b.fieldname===t);return[s==null?void 0:s.label,s==null?void 0:s.fieldtype]},V=()=>p(this,null,function*(){try{yield d.logout.submit()}catch(t){const s="An error occurred while attempting to log out!";console.error(s,t),ee(s)}});return K(()=>{c.emit("doctype_subscribe",g),c.on("list_update",t=>{t.doctype===g&&t.name===n.data.name&&I.reload()})}),S(()=>{c.emit("doctype_unsubscribe",g),c.off("list_update")}),(t,s)=>{const b=z("Button");return _(),G(e(J),null,{default:u(()=>[r(e(H),{class:"ion-padding"},{default:u(()=>{var D,$,j,B;return[a("div",te,[a("div",oe,[a("header",se,[a("div",ae,[r(b,{variant:"ghost",class:"!pl-0 hover:bg-white",onClick:s[0]||(s[0]=l=>e(k).back())},{default:u(()=>[r(e(v),{name:"chevron-left",class:"h-5 w-5"})]),_:1}),ne])]),a("div",le,[e(m).data.user_image?(_(),y("img",{key:0,class:"h-24 w-24 rounded-full object-cover",src:e(m).data.user_image,alt:e(m).data.first_name},null,8,re)):(_(),y("div",ce,w(e(m).data.first_name[0]),1)),a("div",ie,[e(n)?(_(),y("span",de,w(($=(D=e(n))==null?void 0:D.data)==null?void 0:$.employee_name),1)):N("",!0),e(n)?(_(),y("span",me,w((B=(j=e(n))==null?void 0:j.data)==null?void 0:B.designation),1)):N("",!0)]),a("div",ue,[a("div",_e,[(_(),y(U,null,Q(C,l=>a("div",{class:"flex flex-row cursor-pointer flex-start p-4 items-center justify-between border-b",key:l.title,onClick:E=>f(l)},[a("div",pe,[r(e(v),{name:l.icon,class:"h-5 w-5 text-gray-500"},null,8,["name"]),a("div",ye,w(l.title),1)]),r(e(v),{name:"chevron-right",class:"h-5 w-5 text-gray-500"})],8,fe)),64))])]),r(b,{onClick:V,variant:"outline",theme:"red",class:"w-full shadow py-4 mt-5"},{prefix:u(()=>[r(e(v),{name:"log-out",class:"w-4"})]),default:u(()=>[X(" Log Out ")]),_:1})])])]),r(e(Y),{ref:"modal","is-open":i.value,onDidDismiss:O,"initial-breakpoint":1,breakpoints:[0,1]},{default:u(()=>[r(Z,{title:o.value.title,data:o.value.fields.map(l=>{const[E,F]=R(l);return{fieldname:l,value:e(I).doc[l],label:E,fieldtype:F}})},null,8,["title","data"])]),_:1},8,["is-open"])]}),_:1})]),_:1})}}};export{Ie as default};
